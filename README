CARDPATH=/dev/sdd

# Build Device Tree Compiler
cd dtc
make

# Build U-Boot
cd u-boot-sunxi
export PATH=../dtc/:$PATH
make ARCH=arm -j6 CROSS_COMPILE=arm-linux-gnueabi- orangepi_pc_defconfig
make ARCH=arm -j6 CROSS_COMPILE=arm-linux-gnueabi-
# to run u-boot from sdcard:
dd if=u-boot-sunxi-with-spl.bin of=${CARDPATH} bs=1024 seek=8

# Build buildroot initramfs
cd buildroot/
ln -s ../configs/buildroot.config .config
make ARCH=arm -j6 CROSS_COMPILE=arm-linux-gnueabi-

# we need sunxi-fel tool to use FEL mode
cd sunxi-tools/
make
# Create SD card that will automatically enter FEL mode on boot:
dd if=bin/fel-sdboot.sunxi of=${CARDPATH} bs=1024 seek=8

# Build kernel
cd linux/
cp ../configs/kernel.config .config
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- oldconfig
make -j4 ARCH=arm CROSS_COMPILE=arm-linux-gnueabi- LOADADDR=0x40008000 uImage dtbs
